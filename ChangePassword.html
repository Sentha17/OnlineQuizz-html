<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<style>
        /* The message box is shown when the user clicks on the password field */
        #message {
          display:none;
          color: #000;
          position: relative;
        }
        #message p {
          font-size: 18px;
        }
        /* Add a green text color and a checkmark when the requirements are right */
        .valid {
          color: green;
        }
        /* Add a red text color and an "x" when the requirements are wrong */
        .invalid {
          color: red;
        }

        /* The message box is shown when the user clicks on the password field */
        #message1 {
          display:none;
          color: #000;
          position: relative;
        }
        #message1 p {
          font-size: 18px;
        }
        /* Add a green text color and a checkmark when the requirements are right */
        .valid {
          color: green;
        }
        /* Add a red text color and an "x" when the requirements are wrong */
        .invalid {
          color: red;
        }
</style>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
<title>FORGOT PASSWORD</title>
</head>
<body>   
<form onsubmit="checkpass()">
    <br/>
	<center>
        <br/><br/>
        <h1> <center> Change Password</h1>
        <br/>
        <label for="newpassword">New Password:</label> 
        <input type="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9]).{8,}" name="newPassword" id="newpass" required autofocus><br/>
        <br/>
        <label for="reenterPassword">Re-Enter:</label>
        <input type="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9]).{8,}"name="reenter" id="reenterpass" required autofocus><br/>
        <br/>
        <button type="submit"class="btn btn-primary">Submit</button>
        <button type="reset"class="btn btn-primary">Reset</button>
        <br/><br/>
        <label for="validation" id="loginValidation" style="color:red;"></label>
    </center>
</form>
<div id="message">
    <center>
        <h3>Password must contain the following:</h3>
        <p id="letter" class="invalid">A <b>lowercase</b> letter</p>
        <p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
        <p id="number" class="invalid">A <b>number</b></p>
        <p id="length" class="invalid">Minimum <b>8 characters</b></p>
    </center>
</div>
<div id="message1">
    <center>
        <h3>Password must contain the following:</h3>
        <p id="letter1" class="invalid">A <b>lowercase</b> letter</p>
        <p id="capital1" class="invalid">A <b>capital (uppercase)</b> letter</p>
        <p id="number1" class="invalid">A <b>number</b></p>
        <p id="length1" class="invalid">Minimum <b>8 characters</b></p>
    </center>
</div>
<script>
    var passwordMessage = document.getElementById("newpass");
    var letter = document.getElementById("letter");
    var capital = document.getElementById("capital");
    var number = document.getElementById("number");
    var length = document.getElementById("length");
    // When the user clicks on the password field, show the message box
    passwordMessage.onfocus = function() {
    document.getElementById("message").style.display = "block";
    }
    // When the user clicks outside of the password field, hide the message box
    passwordMessage.onblur = function() {
    document.getElementById("message").style.display = "none";
    }
    // When the user starts to type something inside the password field
    passwordMessage.onkeyup = function() {
    
    // Validate lowercase letters
    var lowerCaseLetters = /[a-z]/g;
    if(passwordMessage.value.match(lowerCaseLetters)) {  
        letter.classList.remove("invalid");
        letter.classList.add("valid");
    } else {
        letter.classList.remove("valid");
        letter.classList.add("invalid");
    }
    
    // Validate capital letters
    var upperCaseLetters = /[A-Z]/g;
    if(passwordMessage.value.match(upperCaseLetters)) {  
        capital.classList.remove("invalid");
        capital.classList.add("valid");
    } else {
        capital.classList.remove("valid");
        capital.classList.add("invalid");
    }

    // Validate numbers
    var numbers = /[0-9]/g;
    if(passwordMessage.value.match(numbers)) {  
        number.classList.remove("invalid");
        number.classList.add("valid");
    } else {
        number.classList.remove("valid");
        number.classList.add("invalid");
    }
    
    // Validate length
    if(passwordMessage.value.length >= 8) {
        length.classList.remove("invalid");
        length.classList.add("valid");
    } else {
        length.classList.remove("valid");
        length.classList.add("invalid");
    }
    }

    var reenterPasswordMessage = document.getElementById("reenterpass");
    var letter1 = document.getElementById("letter1");
    var capital1 = document.getElementById("capital1");
    var number1 = document.getElementById("number1");
    var length1 = document.getElementById("length1");
    reenterPasswordMessage.onfocus = function() {
    document.getElementById("message1").style.display = "block";
    }

    // When the user clicks outside of the password field, hide the message box
    reenterPasswordMessage.onblur = function() {
    document.getElementById("message1").style.display = "none";
    }

    // When the user starts to type something inside the password field
    reenterPasswordMessage.onkeyup = function() {
    // Validate lowercase letters
    var lowerCaseLetters1 = /[a-z]/g;
    if( reenterPasswordMessage.value.match(lowerCaseLetters1)) {  
        letter1.classList.remove("invalid");
        letter1.classList.add("valid");
    } else {
        letter1.classList.remove("valid");
        letter1.classList.add("invalid");
    }
    
    // Validate capital letters
    var  upperCaseLetters1 = /[A-Z]/g;
    if(reenterPasswordMessage.value.match(upperCaseLetters1)) {  
        capital1.classList.remove("invalid");
        capital1.classList.add("valid");
    } else {
        capital1.classList.remove("valid");
        capital1.classList.add("invalid");
    }

    // Validate numbers
    var numbers1 = /[0-9]/g;
    if( reenterPasswordMessage.value.match(numbers1)) {  
        number1.classList.remove("invalid");
        number1.classList.add("valid");
    } else {
        number1.classList.remove("valid");
        number1.classList.add("invalid");
    }
    
    // Validate length
    if(reenterPasswordMessage.value.length >= 8) {
        length1.classList.remove("invalid");
        length1.classList.add("valid");
    } else {
        length1.classList.remove("valid");
        length1.classList.add("invalid");
    }
    }
    function checkpass()
    {
        event.preventDefault();
        let newPassword=document.querySelector("#newpass").value;                  
        let reenterPassword=document.querySelector("#reenterpass").value;
        let userName= localStorage.getItem("user");    
        let passwordArray=localStorage.getItem("dob");
        let password=JSON.parse(passwordArray);
        let registerNumberArray=localStorage.getItem("reg");
        let registerNumber=JSON.parse(registerNumberArray);
        //Validation
        if((password.includes(newPassword)==false))
        {
            if(reenterPassword==newPassword)
            {
                let index = registerNumber.indexOf(userName);
                password[index]=newPassword;
                localStorage.setItem("newpass",JSON.stringify(password));
                window.location.href="Signin.html";
            }
            else
            {
                document.getElementById("loginValidation").innerHTML="----Enter the same password----";
            }
        }
        else
        {
            document.getElementById("loginValidation").innerHTML="----Already existing password----";
        }
    }
</script>
</body>
</html>